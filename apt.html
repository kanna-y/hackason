<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãŠè–¬é€šçŸ¥ã‚¢ãƒ—ãƒª</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f1f8e9;
      color: #333;
      padding: 20px;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      font-family: 'Verdana', sans-serif;
      color: #2c6e49;
      text-align: center;
    }

    h2 {
      font-family: 'Verdana', sans-serif;
      color: #5e8f3a;
    }

    input[type="time"] {
      padding: 10px;
      margin: 10px;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
    }

    button {
      padding: 12px 20px;
      background-color: #8bc34a;
      color: white;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #7cb342;
    }

    button:active {
      background-color: #689f38;
    }

    p {
      font-size: 18px;
      color: #555;
    }

    #notifStatus {
      font-size: 16px;
      color: #3e8e41;
    }

    .section {
      margin-bottom: 40px;
      text-align: center;
    }
  </style>
</head>
<body>

  <h1>ğŸ’Š ãŠãã™ã‚Šãƒã‚¤ãƒ³ãƒ€ãƒ¼</h1>

  <div class="section">
    <h2>æ¯æ—¥ã®ãŠè–¬ã®æ™‚é–“ã‚’è¨­å®š</h2>
    <label for="medTime1">1å›ç›®ã®æ™‚é–“:</label>
    <input type="time" id="medTime1">
    
    <label for="medTime2">2å›ç›®ã®æ™‚é–“:</label>
    <input type="time" id="medTime2">
    
    <button onclick="setDailyNotifications()">é€šçŸ¥ã‚’è¨­å®šã™ã‚‹</button>
    <p id="notifStatus"></p>
  </div>

  <div class="section">
    <h2>ãƒ†ã‚¹ãƒˆé€šçŸ¥</h2>
    <button onclick="showCombinedNotification()">ğŸ”” ãƒ†ã‚¹ãƒˆé€šçŸ¥ã‚’é€ã‚‹</button>
  </div>

  <!-- é€šçŸ¥éŸ³ -->
  <audio id="notifySound" src="https://notificationsounds.com/storage/sounds/file-sounds-1152-pristine.mp3" preload="auto"></audio>

  <script>
    let medTimers = [];

    if (Notification.permission !== "granted") {
      Notification.requestPermission().then(permission => {
        if (permission !== "granted") {
          alert("é€šçŸ¥ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼");
        }
      });
    }

    function setDailyNotifications() {
      clearAllTimers();

      const time1 = document.getElementById("medTime1").value;
      const time2 = document.getElementById("medTime2").value;

      if (!time1 && !time2) {
        alert("å°‘ãªãã¨ã‚‚1ã¤ã®æ™‚é–“ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼");
        return;
      }

      if (time1) scheduleDaily(time1);
      if (time2) scheduleDaily(time2);

      document.getElementById("notifStatus").innerText = "æ¯æ—¥ã®é€šçŸ¥ãŒè¨­å®šã•ã‚Œã¾ã—ãŸï¼";
    }

    function scheduleDaily(timeStr) {
      const [hour, minute] = timeStr.split(":").map(Number);
      const now = new Date();
      const nextTime = new Date();

      nextTime.setHours(hour, minute, 0, 0);
      if (nextTime <= now) {
        nextTime.setDate(nextTime.getDate() + 1);
      }

      const delay = nextTime - now;
      const timer = setTimeout(() => {
        showCombinedNotification();
        scheduleDaily(timeStr); // ç¿Œæ—¥ã‚‚å†è¨­å®š
      }, delay);

      medTimers.push(timer);
    }

    function clearAllTimers() {
      medTimers.forEach(timer => clearTimeout(timer));
      medTimers = [];
    }

    function showCombinedNotification() {
      const message = getMedicalMessage();
      showNotification("ğŸ’Š ãŠè–¬ã®æ™‚é–“ã ã‚ˆï¼", message);
    }

    function showNotification(title, message) {
      if (Notification.permission === "granted") {
        new Notification(title, {
          body: message,
          icon: "https://cdn-icons-png.flaticon.com/512/2965/2965567.png"
        });

        // ãƒ”ã‚³ãƒ³éŸ³å†ç”Ÿ
        const sound = document.getElementById("notifySound");
        sound.currentTime = 0;
        sound.play();
      }
    }

    function getMedicalMessage() {
      const messages = [
        "ğŸŒ¼ èŠ±ç²‰æƒ…å ±ï¼šä»Šé€±ã¯ãƒ’ãƒã‚­èŠ±ç²‰ãŒå¤šãé£›ã‚“ã§ã„ã¾ã™ã€‚å¤–å‡ºæ™‚ã¯çœ¼é¡ã¨ãƒã‚¹ã‚¯ã‚’å¿˜ã‚Œãšã«ã€‚",
        "ğŸ¦  æµè¡Œæƒ…å ±ï¼šãƒãƒ­ã‚¦ã‚¤ãƒ«ã‚¹ã®æ„ŸæŸ“å ±å‘ŠãŒå¢—åŠ ä¸­ã€‚æ‰‹æ´—ã„ãƒ»ã†ãŒã„ã‚’å¾¹åº•ã—ã¾ã—ã‚‡ã†ã€‚",
        "ğŸ’– ã‚ã£ãŸã‹ã„ä¸€è¨€ï¼šã‚ãªãŸã®å¥åº·ã‚’é¡˜ã£ã¦ã€ä»Šæ—¥ã‚‚å¿œæ´ã—ã¦ã„ã¾ã™ã€‚",
        "ğŸŒ¸ èŠ±ç²‰ç—‡å¯¾ç­–ï¼šå¤–ã‹ã‚‰å¸°ã£ãŸã‚‰æœã‚’æ‰•ã£ã¦ã€ã™ãã«ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’æµ´ã³ã‚‹ã¨åŠ¹æœçš„ã§ã™ã€‚",
        "ğŸ§˜â€â™€ï¸ äºˆé˜²åŒ»å­¦ï¼š1æ—¥15åˆ†ã®è»½ã„é‹å‹•ã§ã‚‚ã€å…ç–«åŠ›ãŒãã£ã¨ä¸ŠãŒã‚‹ã‚ˆï¼",
        "â˜€ï¸ ã‚ã£ãŸã‹ã„ä¸€è¨€ï¼šä»Šæ—¥ã®ã‚ãªãŸã‚‚ã€ååˆ†é ‘å¼µã£ã¦ã‚‹ã€‚å°‘ã—ä¼‘ã‚“ã§ã‚‚å¤§ä¸ˆå¤«ã€‚",
        "ğŸµ ä½“ã‚’å†·ã‚„ã•ãªã„ã‚ˆã†ã«ã€ã‚ã£ãŸã‹ã„é£²ã¿ç‰©ã‚’é£²ã‚“ã§ã­ã€‚",
        "ğŸ’¬ èª°ã‹ã«ã€ã‚ã‚ŠãŒã¨ã†ã€ã£ã¦ä¼ãˆã‚‹ã ã‘ã§ã€è‡ªåˆ†ã®å¿ƒã‚‚ãƒã‚«ãƒã‚«ã«ãªã‚‹ã‚ˆã€‚",
        "ğŸ›Œ ã—ã£ã‹ã‚Šå¯ã¦ã‚‹ï¼Ÿç¡çœ ã¯æœ€é«˜ã®è–¬ï¼",
        "ğŸ§´ ä¹¾ç‡¥å¯¾ç­–ï¼šåŠ æ¹¿å™¨ã‚„æ¿¡ã‚Œã‚¿ã‚ªãƒ«ã§ãŠéƒ¨å±‹ã®æ¹¿åº¦ã‚’ã‚­ãƒ¼ãƒ—ã—ã‚ˆã†ï¼"
      ];
      const i = Math.floor(Math.random() * messages.length);
      return messages[i];
    }
  </script>
</body>
</html>
